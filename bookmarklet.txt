javascript:!function e(){if(window.__searchMonitorInstalled){console.warn("Search monitor already installed.");return}function t(e){try{let t=new URL(e,location.href);return t.pathname.includes("/search")||t.href.includes("/search")}catch{return String(e||"").includes("/search")}}function r(e){return String(e).replace(/^\)\]\}'\s*\n?/,"")}function n(e){return String(e).replace(/\/\*[\s\S]*?\*\/\s*$/,"")}function o(e){try{return JSON.parse(e)}catch{return null}}function s(e){if(!e)return null;let t=o(e);if(t){if(t&&t.d&&"string"==typeof t.d){let s=o(n(r(t.d)));return s??t}return t}let l=r(e);if(t=o(n(l)))return t;try{let a=JSON.parse('"'+e.replace(/\\([\s\S])/g,"\\$1").replace(/"/g,'\\"')+'"'),c=o(n(r(a)));if(c)return c}catch{}return null}function l(e){try{return JSON.stringify(e,null,2)}catch(t){return"[unserializable object: "+t.message+"]"}}function a(e,t,r){try{let n=s(r);if(null!=n){let o=s(n.d),l=o[64];if(console.log(l),Array.isArray(l)){let a=l.filter(e=>Array.isArray(e)&&e.length>1&&Array.isArray(e[1])).map(e=>{let t=e[1],r=null;if(Array.isArray(t[25])&&t[25].length>3){let n=t[25][3];if(Array.isArray(n)){for(let o of n)if(Array.isArray(o)&&o[10]){let s=o[10];"number"==typeof s&&(!r||s>r)&&(r=s)}}}if(!r&&Array.isArray(t[25])&&Array.isArray(t[25][1])){let l=t[25][1];l.length>10&&"number"==typeof l[10]&&(r=l[10])}let a=null;try{let c=t[24]?.[0]?.[4];if("string"==typeof c&&c.startsWith("ChIJ")&&(a=c),!a&&t[4]?.[3]?.[0]){let i=t[4][3][0];if("string"==typeof i){let d=i.match(/placeid=([A-Za-z0-9_-]+)/);d&&d[1].startsWith("ChIJ")&&(a=d[1])}}}catch{}return{id:t[1]||null,name:t[6]||(Array.isArray(t[3])?t[3].join(", "):null),placeId:a,coordinates:{lat:t[9]?.[2]||null,lng:t[9]?.[3]||null,string:t[11]||null},address:Array.isArray(t[3])?t[3].join(", "):t[183]||null,fullAddress:t[18]||null,types:Array.isArray(t[13])?t[13]:[],rating:t[4]?.[7]||null,reviewCount:t[4]?.[8]||null,website:t[7]?.[0]||null,phone:t[178]?.[0]?.[0]||null,openingHours:t[34]?.[1]||null,photos:(t[72]||t[92])?.slice(0,3).map(e=>e?.[6]?.[0])||[],categoryPath:t[76]||null,priceLevel:t[4]?.[2]||null,timestamp:r,timestampDate:r?new Date(r).toISOString():null}});a.forEach(e=>{let t=window.__collectedPlaces.findIndex(t=>t.placeId&&t.placeId===e.placeId);-1===t&&window.__collectedPlaces.push(e)});let c;(c=document.getElementById("__mapsExportBtn"))||((c=document.createElement("button")).id="__mapsExportBtn",c.style.cssText=`
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 99999;
        padding: 12px 24px;
        background: #4285f4;
        color: white;
        border: none;
        border-radius: 24px;
        font-family: 'Google Sans', Arial, sans-serif;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        transition: all 0.2s;
      `,c.onmouseover=()=>{c.style.background="#357ae8",c.style.boxShadow="0 4px 12px rgba(0,0,0,0.4)"},c.onmouseout=()=>{c.style.background="#4285f4",c.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)"},c.onclick=()=>{let e=window.__collectedPlaces;console.groupCollapsed(`ðŸ“ Collected Places (${e.length} total)`),e.forEach((e,t)=>{console.groupCollapsed(`${t+1}. ${e.name||e.coordinates.string||"Unnamed"} ${e.rating?"â­ "+e.rating:""}`),console.log(e),console.groupEnd()}),console.groupEnd();let t=["Title,Note,URL,Tags,Comment"];e.forEach(e=>{let r=(e.name||e.coordinates.string||"").replace(/"/g,'""'),n=(e.timestampDate||"").replace(/"/g,'""'),o=e.placeId?`https://www.google.com/maps/place/?q=place_id:${e.placeId}`:e.coordinates.lat&&e.coordinates.lng?`https://www.google.com/maps/search/${e.coordinates.lat},${e.coordinates.lng}`:"";t.push(`"${r}","${n}",${o},,`)});let r=t.join("\n");console.log("\n\uD83D\uDCC4 CSV Content:\n"),console.log(r);let n=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),s=URL.createObjectURL(n);o.setAttribute("href",s),o.setAttribute("download",`google-maps-starred-${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),alert(`Downloaded ${e.length} places as CSV!`)},document.body.appendChild(c)),c.textContent=`ðŸ“ Export (${window.__collectedPlaces.length})`,console.groupCollapsed(`ðŸ“ Parsed ${a.length} search results (Total: ${window.__collectedPlaces.length})`),a.forEach((e,t)=>{console.groupCollapsed(`${t+1}. ${e.coordinates.string||"Unnamed"} ${e.rating?"â­ "+e.rating:""}`),console.log(e),console.groupEnd()}),console.groupEnd()}else console.log("Raw dParsed[64]:",l)}}catch(i){console.error("[search-monitor] Error in maybePrettyPrintParsed:",i)}}window.__searchMonitorInstalled=!0,window.__collectedPlaces||(window.__collectedPlaces=[]);let c=window.fetch;window.fetch=function(e,r){try{let n=r&&r.method||e&&e.method||"GET",o=e&&e.url||e;t(o)&&(e instanceof Request?e.clone().text().then(t=>{console.info("[search-monitor] fetch request detected",{type:"fetch",method:n,url:e.url||o,body:t||r&&r.body||null})}).catch(()=>console.info("[search-monitor] fetch request detected (no body)",{type:"fetch",method:n,url:o})):console.info("[search-monitor] fetch request detected",{type:"fetch",method:n,url:o,body:r&&r.body||null}))}catch{}return c.apply(this,arguments).then(e=>{try{t(e.url)&&e.clone().arrayBuffer().then(t=>{let r="";try{r=new TextDecoder().decode(new Uint8Array(t))}catch{r=`[arraybuffer ${t?t.byteLength:0} bytes]`}let n={};try{for(let[o,s]of e.headers.entries())n[o]=s}catch{}console.info("[search-monitor] fetch response detected",{type:"fetch",url:e.url,status:e.status,headers:n,body:r}),"string"==typeof r&&a("[search-monitor] fetch response",e.url,r)}).catch(()=>{e.clone().text().then(t=>{let r={};try{for(let[n,o]of e.headers.entries())r[n]=o}catch{}console.info("[search-monitor] fetch response detected",{type:"fetch",url:e.url,status:e.status,headers:r,body:t}),"string"==typeof t&&a("[search-monitor] fetch response",e.url,t)}).catch(()=>console.info("[search-monitor] fetch response detected (no body)",{type:"fetch",url:e.url,status:e.status}))})}catch{}return e})};let i=window.XMLHttpRequest;function d(){let e=new i,r=null,n=null,o={},s=e.open,l=e.send;function c(){if(4===e.readyState){let o=e.responseURL||r;if(!t(o))return;let s="[unavailable]";try{s=e.getAllResponseHeaders?e.getAllResponseHeaders():s}catch{}!function e(t,r){try{let n=t.responseType;if("arraybuffer"===n&&t.response)try{r(new TextDecoder().decode(new Uint8Array(t.response)))}catch{r(`[arraybuffer ${t.response.byteLength||0} bytes]`)}else if("blob"===n&&t.response)try{let o=new FileReader;o.onload=()=>r(String(o.result)),o.onerror=()=>r("[blob read error]"),o.readAsText(t.response)}catch{r("[blob unreadable]")}else if("document"===n&&t.response)try{r(new XMLSerializer().serializeToString(t.response))}catch{r("[document response]")}else if("json"===n)try{r(JSON.stringify(t.response))}catch{r("[json unreadable]")}else try{r(t.responseText)}catch{try{r("string"==typeof t.response?t.response:"[non-text response or unavailable]")}catch{r("[error reading response]")}}}catch(s){r("[error reading response: "+s+"]")}}(e,function(t){console.info("[search-monitor] XHR response detected",{type:"xhr",method:n,url:o,status:e.status,headers:s,body:t}),"string"==typeof t&&a("[search-monitor] XHR response",o,t)})}}return e.open=function(e,t){return n=e,r=t,s.apply(this,arguments)},e.setRequestHeader=function(e,t){try{o[e]=t}catch{}return i.prototype.setRequestHeader.apply(this,arguments)},e.addEventListener("load",c),e.addEventListener("readystatechange",c),e.addEventListener("error",function(){let o=e.responseURL||r;t(o)&&console.info("[search-monitor] XHR error",{type:"xhr",method:n,url:o,status:e.status})}),e.send=function(e){try{if(t(r)){let s=null;try{if(null==e)s=null;else if("string"==typeof e)s=e;else if(e instanceof FormData){let a=[];for(let c of e.entries())a.push(`${c[0]}=${c[1]}`);s=a.join("&")}else if(e instanceof ArrayBuffer)s=`[arraybuffer ${e.byteLength} bytes]`;else if(ArrayBuffer.isView(e))s=`[typed array ${e.byteLength} bytes]`;else try{s=JSON.stringify(e)}catch{s="[unserializable body]"}}catch{s="[error reading body]"}console.info("[search-monitor] XHR request detected",{type:"xhr",method:n,url:r,headers:o,body:s})}}catch{}return l.apply(this,arguments)},e}d.prototype=i.prototype,window.XMLHttpRequest=d,console.info('Search monitor installed â€” requests & responses (incl. JSON parsing) for "/search".')}();
